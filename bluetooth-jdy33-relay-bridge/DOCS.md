# Bluetooth JDY-33 Relay Bridge (Home Assistant add-on)

MQTT-–º–æ—Å—Ç –¥–ª—è Bluetooth-–º–æ–¥—É–ª–µ–π **JDY-33-BLE** (—Å–æ–≤–º–µ—Å—Ç–∏–º —Å BT05 / JDY-08, –Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ), —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø–æ BLE (GATT).  

–ü–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–µ–ª–µ –ø—Ä—è–º–æ –∏–∑ Home Assistant ‚Äî **–±–µ–∑ rfcomm, –±–µ–∑ SPP-–ø–æ—Ä—Ç–∞ –∏ –±–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–∞**.

–ê–¥–¥–æ–Ω –ø—É–±–ª–∏–∫—É–µ—Ç –≤ Home Assistant **MQTT-—Å–≤–∏—Ç—á** —á–µ—Ä–µ–∑ Discovery –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–ª–µ –ø–æ BLE (—á–µ—Ä–µ–∑ GATT-—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É).

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞
–õ–æ–∫–∞–ª—å–Ω–æ:

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É `bluetooth-jdy33-relay-bridge` –≤ –∫–∞—Ç–∞–ª–æ–≥ `/addons/` –≤–∞—à–µ–≥–æ Home Assistant.  
2. –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ HA:  
   **Settings ‚Üí Add-ons ‚Üí Local add-ons ‚Üí Bluetooth JDY-33 Relay Bridge ‚Üí Install**
3. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–¥–æ–Ω, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞–∂–º–∏—Ç–µ **Start**.

–ß–µ—Ä–µ–∑ –º–∞–≥–∞–∑–∏–Ω –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π:

1. –î–æ–±–∞–≤—å—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π https://github.com/alexanderznamensky/home-assistant-addons –≤ –º–∞–≥–∞–∑–∏–Ω–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π.
2. –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ HA:  
   **Settings ‚Üí Add-ons ‚Üí Home Assistant Addons ‚Üí Bluetooth JDY-33 Relay Bridge ‚Üí Install**
3. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–¥–æ–Ω, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞–∂–º–∏—Ç–µ **–ó–∞–ø—É—Å—Ç–∏—Ç—å**.

---

## üîå –ù–∞—Å—Ç—Ä–æ–π–∫–∞
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------|----------------------|-----------|
| `MQTT_HOST` | str | `core-mosquitto` | –ê–¥—Ä–µ—Å MQTT-–±—Ä–æ–∫–µ—Ä–∞ |
| `MQTT_PORT` | int | `1883` | –ü–æ—Ä—Ç –±—Ä–æ–∫–µ—Ä–∞ |
| `MQTT_USER` / `MQTT_PASS` | str | ‚Äî | –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |
| `MQTT_PREFIX` | str | `bluetoothrelay` | –ü—Ä–µ—Ñ–∏–∫—Å MQTT-—Ç–æ–ø–∏–∫–æ–≤ |
| `RELAY_NAME` | str | `Bluetooth JDY-33 Relay` | –ò–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ |
| `RELAY_ID` | str | `jdy33_relay` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –≤ HA |
| `BLE_ADDR` | str | ‚Äî | MAC-–∞–¥—Ä–µ—Å –º–æ–¥—É–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä `01:B6:EC:11:EF:26`) |
| `BLE_NAME` | str | `JDY` | –ò–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –µ—Å–ª–∏ –∞–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω |
| `BLE_WRITE_CHAR` | str | `0000ffe1-0000-1000-8000-00805f9b34fb` | UUID —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–∞–ø–∏—Å–∏ |
| `CONNECTION_MODE` | bool | `false` | üîÅ –†–µ–∂–∏–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: **off** = ON_DEMAND (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –∫–æ–º–∞–Ω–¥–µ), **on** = PERSISTENT (–¥–µ—Ä–∂–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ) |
| `IDLE_DISCONNECT_SEC` | int | `5` | –í—Ä–µ–º—è –ø—Ä–æ—Å—Ç–æ—è –¥–æ —Ä–∞–∑—Ä—ã–≤–∞ BLE-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–∞–∫—Ç–∏–≤–Ω–æ —Ç–æ–ª—å–∫–æ –≤ ON_DEMAND) |
| `CMD_ON_HEX` | str | `A00101A2` | HEX-–∫–æ–º–∞–Ω–¥–∞ –≤–∫–ª—é—á–µ–Ω–∏—è |
| `CMD_OFF_HEX` | str | `A00100A1` | HEX-–∫–æ–º–∞–Ω–¥–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏—è |

---

## üì° –¢–µ–º—ã MQTT
| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –¢–æ–ø–∏–∫ | Payload |
|-------------|--------|----------|
| **Command** | `<MQTT_PREFIX>/command` | `ON` / `OFF` / `RAW:<HEX>` / `DISCONNECT` |
| **State** | `<MQTT_PREFIX>/state` | `ON` / `OFF` |
| **Availability** | `<MQTT_PREFIX>/availability` | `online` / `offline` |

---

## –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é HEX:
- ON: `A0 01 01 A2`
- OFF: `A0 01 00 A1`

## üß© MQTT Discovery

---

–ê–¥–¥–æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—É–±–ª–∏–∫—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è Home Assistant –≤ —Ç–æ–ø–∏–∫–µ.
